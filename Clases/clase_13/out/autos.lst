     1                                  ;Se cuenta con un archivo listado.dat en formato binario con informacion de autos. Cada registro tiene los campos:
     2                                  ;- Marca: 20 caracteres ascii
     3                                  ;- Modelo: 20 caracteres ascii
     4                                  ;- AÃ±o: 2 bytes bpf s/s
     5                                  ;Se pide realizar un programa que pida ingresar por teclado una marca de automovil e imprima por pantalla todos los autos de dicha marca que se encuentran en el archivo.
     6                                  ;Las marcas validas son Fiat, Ford, Chevrolet y Peugeot y se debera validar que la marca ingresada sea alguna de ellas previo a la busqueda en el archivo.
     7                                  
     8                                  %macro mGets 1
     9                                      mov rdi, %1
    10                                      sub rsp,8
    11                                      call gets
    12                                      add rsp,8
    13                                  %endMacro
    14                                  
    15                                  %macro mPuts 1
    16                                      mov rdi,%1
    17                                      sub rsp,8
    18                                      call puts
    19                                      add rsp,8
    20                                  %endMacro
    21                                  
    22                                  global main
    23                                  extern gets
    24                                  extern puts
    25                                  extern strlen
    26                                  
    27                                  section .data
    28 00000000 496E6772657365206C-         msgInAuto db "Ingrese la marca de auto: ",0
    28 00000009 61206D617263612064-
    28 00000012 65206175746F3A2000 
    29 0000001B 466961742020202020-         arrMarcas db "Fiat      Ford    Chevrolet Peugeot  "
    29 00000024 20466F726420202020-
    29 0000002D 43686576726F6C6574-
    29 00000036 2050657567656F7420-
    29 0000003F 20                 
    30 0000003F <rep Ah>                    marca10Chars times 10 db ""
    31                                  
    32                                  section .bss
    33 00000000 <res 64h>                   inMarca resb 100; No le pongo 20 para evitar conflictos.
    34                                  
    35                                  section .text
    36                                  main:
    37                                      mPuts msgInAuto
    16 00000000 48BF-               <1>  mov rdi,%1
    16 00000002 [0000000000000000]  <1>
    17 0000000A 4883EC08            <1>  sub rsp,8
    18 0000000E E8(00000000)        <1>  call puts
    19 00000013 4883C408            <1>  add rsp,8
    38                                      mGets inMarca
     9 00000017 48BF-               <1>  mov rdi, %1
     9 00000019 [0000000000000000]  <1>
    10 00000021 4883EC08            <1>  sub rsp,8
    11 00000025 E8(00000000)        <1>  call gets
    12 0000002A 4883C408            <1>  add rsp,8
    39                                  
    40 0000002E 48BF-                       mov rdi, inMarca
    40 00000030 [0000000000000000] 
    41 00000038 4883EC08                    sub rsp, 8
    42 0000003C E8(00000000)                call strlen
    43 00000041 4883C408                    add rsp,8
    44                                  
    45 00000045 C3                          ret
